<!DOCTYPE html>
<html lang="en">

<head>
	${require('./partials/shared/_head.html')}

	<title>FII Student - Camere libere</title>

	<script>
		const title = 'Camere libere';
		const subtitle = 'Cauta o camera libera';
		const shouldBeLoggedIn = true;
	</script>

	<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
	<script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
	<link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet" type="text/css" />

</head>

<body>
	${require('./partials/shared/navbar.html')}

	${require('./partials/shared/page-header.html')}

	<div class="container-fluid">
		<div class="container">
			<div class="section">
				<div class="content">
					<div class="align-middle">
						<h2>Căutare săli libere in interval orar </h2>
					</div>
					<div class="row border-top">
						<div class="sidebar ">


							<a href="#">Sali si resurse</a>


							<a href="#">Orar Profesori</a>


							<a href="#">Orar Studenti</a>


						</div>
						<div class="search-room col-sm-10 col-md-10 border-left">
							<div class="search-form m-auto">
								<div class="row pad-left border-bottom pad-bot">
									<div class="container" id="dates">


										<div class="row">
											<div class='col-sm-3'>
												Data
												<div class="form-group">
													<div class='input-group datepicker' id='datetimepicker1'>
														<input id="datepicker" width="276" />
													</div>
												</div>
											</div>
											<div class=" col-sm-3 ">
												Ora de start
												<div class="control-group">

													<select name="start-hour" id="starthour" id="start-hour"
														class="form-control">
														<option value="" selected="selected"></option>
														<option value="1">1</option>
														<option value="2">2</option>
														<option value="3">3</option>
														<option value="4">4</option>
														<option value="5">5</option>
														<option value="6">6</option>
														<option value="7">7</option>
														<option value="8">8</option>
														<option value="9">9</option>
														<option value="10">10</option>
														<option value="11">11</option>
														<option value="12">12</option>
														<option value="13">13</option>
														<option value="14">14</option>
														<option value="15">15</option>
														<option value="16">16</option>
														<option value="17">17</option>
														<option value="18">18</option>
														<option value="19">19</option>
														<option value="20">20</option>
														<option value="21">21</option>
														<option value="22">22</option>
														<option value="23">23</option>
														<option value="24">24</option>

													</select>
												</div>
											</div>
											<div class=" col-sm-3 ">
												Durata(h)
												<div class="control-group">

													<select name="duration" id="duration" class="form-control">
														<option value="" selected="selected"></option>
														<option value="1">1</option>
														<option value="2">2</option>
														<option value="3">3</option>
														<option value="4">4</option>
														<option value="5">5</option>
														<option value="6">6</option>
														<option value="7">7</option>
														<option value="8">8</option>
														<option value="9">9</option>
														<option value="10">10</option>
														<option value=11>11</option>
														<option value="12">12</option>
													</select>
												</div>
											</div>
											<div class="col-sm-3">

												<div class="control-group">
													<button type="submit" class="btn btn-primary" id="searchBTN">Cauta
														sala </button>
												</div>
											</div>
										</div>
									</div>

								</div>

								<!--aici va aparea lista de sali-->
								<div class="row">
									<div class="col-md-10">
										<h4>Rezultat:</h4>
									</div>

								</div>
								<div class="row">
									<div class="col-md-10" id="result">
										<p id="eroare"></p>


									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script>
		$('#datepicker').datepicker({
			uiLibrary: 'bootstrap4'
		});
	</script>


	<script>

		$('#searchBTN').click(function () {
			var datetime = window.document.getElementById("datepicker").value;
			var startHour = $('#starthour option:selected').val();
			var duration = $('#duration option:selected').val();
			$.ajax({

				url: endpoint + "free_rooms",
				type: "GET",
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				beforeSend: function (xhr) {
					xhr.setRequestHeader('Authorization', 'Bearer ' + sessionStorage.getItem("accessToken"));
				},
				data: {
					date: datetime,
					start_hour: startHour,
					duration: duration
				},
				success: function (result) {
					var resultat = "";
					var json = result;
					obj = JSON.parse(json);
					console.log(obj);
					if (obj.length == 0) {
						alert('Nu s-a gasit nici o sala libera');

					}
					else {
						for (i = 0; i < obj.length; i++)
						{
							var room = obj[i].room;
							var disponibility = obj[i].disponibility;
							resultat += "<p><strong>Sala:</strong> " + room + "</p>" + "<p ><strong>Disponibilitate :</strong>" + disponibility + "</p>";
						}
						}
							$('div#result').append(resultat);
				},
				error: function () {
					
					alert('Oh-oh! Ceva nu a mers bine!')
				}
			})
		})
	</script>
	${require('./partials/shared/footer.html')}

</body>

</html>