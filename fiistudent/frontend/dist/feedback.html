<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" crossorigin="anonymous" />
<script src="https://code.jquery.com/jquery-3.4.0.min.js"
    integrity="sha256-BJeo0qm959uMBGb65z40ejJYGSgR7REI4+CW1fNKwOg=" crossorigin="anonymous"></script>

<script>
    const endpoint = "https://develop-dot-fii-student.appspot.com/";
    const isTeacher = false;
    const isStudent = false;
</script>

<script>
    (function () {
        'use strict';
        window.addEventListener('load', function () {
            var forms = document.getElementsByClassName('needs-validation');

            var validation = Array.prototype.filter.call(forms, function (form) {
                form.addEventListener('submit', function (event) {
                    if (form.checkValidity() === false) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    
                    form.classList.add('was-validated');

                }, false);
            });
        }, false);
    })();

    function logOut() {
        sessionStorage.removeItem("accessToken");
        window.location.reload();
    }
</script>

    <title>FII Student - Vizualizare Feedback</title>

    <script>
        const title = 'Vizualizare Feedback';
        const subtitle = 'Află ce părere au studenții despre tine';
        const shouldBeLoggedIn = true;
    </script>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
    <link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet" type="text/css" />

</head>

<body>

    <!--Modal Quick Email-->
<div class="modal sign-modal fade" id="quickEmailModal" tabindex="-1" role="dialog"
    aria-labelledby="qucikEmailModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-body">

                <div class="header">
                    <h6 class="over-title">Trimite email</h6>
                </div>
                <div class="content">
                    <form id="quick-emailFrom" class="needs-validation" novalidate>
                        <div class="form-group">
                            <input type="hidden" id="id-teacher" value="" required />
                        </div>
                        <div class="form-group">
                            <label for="subject">Subiect</label>
                            <input type="text" class="form-control" id="subject" placeholder="Introduceți subiectul" required>
                        </div>
                        <div class="form-group">
                            <label for="message">Mesaj</label>
                            <textarea type="text" id="message" name="message" rows="4" class="form-control"
                                placeholder="Indroduceți mesajul..." required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Trimite</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $('#quick-emailFrom').submit(function (event) {
        event.preventDefault();

        if (!this.checkValidity()) {
            return;
        }

        $.ajax({
            url: endpoint + "quickmail",
            beforeSend: function (xhr) {
                xhr.setRequestHeader('Authorization', 'Bearer ' + sessionStorage.getItem("accessToken"));
            },
            data: {
                urlsafe: $(this).find('#id-teacher').val(),
                subject: $(this).find('#subject').val(),
                content: $(this).find('#message').val()
            }
        }).then(function (data) {
            if (data.status === "error") {
                alert(data.errors[0].message);
            }

            if (data.status === "ok") {
                $('#quickEmailModal').modal('toggle');
            }

            $('#id-teacher').val('');
            $('#subject').val('');
            $('#message').val('');
        });
    });

    function sendEmail(teacherId) {
        $('#id-teacher').val(teacherId);
    }
</script>

    <div class="d-flex" id="wrapper">
        <div class="border-right" id="sidebar-wrapper">
    <div class="sidebar-heading">
        <img src="src/assets/img/navedit4.png" class="profile-picture" alt="profile-pic" />
        <p class="name" id="userName">Ursaciuc Adrian</p>
    </div>
    <div class="list-group list-group-flush">
        <a href="dashboard.html" class="list-group-item list-group-item-action ch for-student"><i class="fas fa-columns"></i>Panou principal</a>
        <a href="#ads_category" class="list-group-item list-group-item-action dropdown-toggle ch for-student" data-toggle="collapse" aria-expanded="false"><i class="fas fa-rss"></i>Anunțuri</a>
        <ul class="collapse list-unstyled pl-3" id="ads_category">
            <li>
                <a href="anounces.html" class="list-group-item list-group-item-action item-secondary ch">Anunțuri noi</a>
            </li>
            <li>
                <a href="license-exams.html" class="list-group-item list-group-item-action item-secondary ch">Examene de licență</a>
            </li>
            <li>
                <a href="dissertation-exams.html" class="list-group-item list-group-item-action item-secondary ch">Examene de disertație</a>
            </li>
        </ul>


        <a href="free-rooms.html" class="list-group-item list-group-item-action"><i class="fas fa-door-closed"></i>Săli libere</a>
        <a href="schedule.html" class="list-group-item list-group-item-action for-student"><i class="fas fa-calendar"></i>Orar</a>
        <a href="subjects.html" class="list-group-item list-group-item-action"><i class="fas fa-book"></i>Materii</a>
        <a href="teachers.html" class="list-group-item list-group-item-action"><i class="fas fa-user-graduate"></i>Profesori</a>
        <a href="notifications.html" class="list-group-item list-group-item-action for-student"><i class="fas fa-bell"></i>Notificari</a>
        <a href="customschedule.html" class="list-group-item list-group-item-action for-student"><i class=" fas fa-calendar"></i>Orar personalizat</a>
        <a href="feedback.html" class="list-group-item list-group-item-action for-teacher"><i class="fas fa-bell"></i>Feedback</a>
        <a href="sendAnnounces.html" class="list-group-item list-group-item-action for-teacher"><i class="fas fa-bell"></i>Trimite anunt</a>
        <a href="javascript:void(0)" class="list-group-item list-group-item-action" onclick="logOut()"><i class="fas fa-sign-out-alt"></i>Deconectează-te</a>

    </div>
</div>

<script>
    $(document).ready(function() {
        $.ajax({
            url: endpoint + "identity",
            method: 'GET',
            beforeSend: function (xhr) {
                xhr.setRequestHeader('Authorization', 'Bearer ' + sessionStorage.getItem("accessToken"));
            }
        }).then(function (result) {
            if(result.data.type === 'student') {
                $('.for-teacher').remove();
                isStudent = true;
            }
            if(result.data.type === 'professor') {
                $('.for-student').remove();
                isTeacher = true;
            }

            $('#userName').val(result.data.name);
        });
    });
</script>

        <div id="page-content-wrapper" class="bg-light">
            <script>

    document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('header-title').innerText = title;
        document.getElementById('header-subtitle').innerText = subtitle;
    }, false);

</script>

<div class="container-fluid page-header">
    <h2 class="title" id="header-title"></h2>
    <h4 class="subtitle" id="header-subtitle"></h4>
</div>

            <div class="container d-flex flex-wrap justify-content-center" id="containerFeedback">
            </div>
        </div>
    </div>
<script type="text/javascript" src="main.aba0b23d1cfdda03dac8.js"></script></body>
<script>

    $(document).ready(function () {
        $.ajax({
            url: endpoint + "feedback",
            beforeSend: function (xhr) {
                xhr.setRequestHeader('Authorization', 'Bearer ' + sessionStorage.getItem("accessToken"));

            },
        }).then(function (data) {

            // Botez a trecut pe aici
            for (var indice = 0; indice < data.length; indice++) {
                var div = document.createElement("div");
                div.className += "card";
                div.className += " text-center";
                div.className += " col-md-5";
                div.className += " mx-4";
                var parent = document.getElementById("containerFeedback");
                parent.appendChild(div);
                //am terminat div ul principal
                var div2 = document.createElement("div");
                div2.className += " newFeedback";
                div2.className += " px-3";
                div2.innerHTML = "Nou";
                parent.appendChild(div);
                div.appendChild(div2);
                //am terminat al doilea div
                var divCard = document.createElement("div");
                divCard.className += " card-body";
                div.appendChild(divCard);
                var section = document.createElement("section");
                section.id = "stars";
                divCard.appendChild(section);
                var divRating = document.createElement("div");
                divRating.className += " rating-stars";
                divRating.className += " text-center";
                section.appendChild(divRating);
                var ul = document.createElement("ul");
                divRating.appendChild(ul);
                for (var i = 0; i < data[indice].stars; i++) {
                    let li = document.createElement("li");
                    li.className += " star";
                    li.className += " d-inline";
                    let i = document.createElement("i");
                    i.className += " fa";
                    i.className += " fa-star";
                    i.className += " fa-fw";
                    i.className += " text-warning";
                    li.appendChild(i);
                    ul.appendChild(li);

                }
                let p = document.createElement('p');
                p.className += "card-text";
                p.innerHTML = data[indice].feedback;
                divCard.appendChild(p);
                let divFooter = document.createElement("div");
                divFooter.className += " card-footer";
                divFooter.className += " text-muted";
                divFooter.innerHTML += data[indice].date;
                div.appendChild(divFooter);
            }
        });
    });

</script>

</html>

<script>
    $(document).ready(function () {
        var allNew = document.querySelectorAll(".newFeedback");

        for (var i = 0; i < allNew.length; i++) {
            allNew[i].onclick = function () {
                this.style.display = 'none';
            }
        };
    });
</script>